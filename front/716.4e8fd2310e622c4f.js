"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[716],{1716:(N,h,e)=>{e.r(h),e.d(h,{LoginModule:()=>F});var p=e(6814),l=e(4190),r=e(6223),f=e(8180),v=e(4716),w=e(9530),t=e(9212),I=e(173),u=e(8672),C=e(1154),Z=e(5470),m=e(2032),d=e(9157),g=e(2296);function T(i,a){1&i&&(t.TgZ(0,"mat-error"),t._uU(1,"You must enter a value"),t.qZA())}function y(i,a){1&i&&(t.TgZ(0,"mat-error"),t._uU(1,"Not a valid email"),t.qZA())}function A(i,a){1&i&&(t.TgZ(0,"mat-error"),t._uU(1,"Password or Email Incorrect!"),t.qZA())}function U(i,a){1&i&&(t.TgZ(0,"mat-error"),t._uU(1,"You must enter a value"),t.qZA())}function b(i,a){1&i&&(t.TgZ(0,"button",6),t._uU(1,"Login"),t.qZA())}function E(i,a){1&i&&(t.TgZ(0,"button",8),t._uU(1,"Login"),t.qZA())}function L(i,a){if(1&i&&(t.TgZ(0,"div",9),t._UZ(1,"ngx-spinner",10),t.qZA()),2&i){const o=t.oxw();t.Udp("position","absolute")("width",o.container_width)("height",o.container_height),t.xp6(1),t.Q6J("fullScreen",!1)}}const S=[{path:"",component:(()=>{class i{constructor(o,s,n,c,J,j){this.router=o,this.store=s,this.spinner=n,this.formBuilder=c,this.authServ=J,this.siteAdjustments=j,this.loadingState=!1,this.container_width=window.innerWidth<=700?"95%":"50%",this.container_height=window.innerWidth<=700?"75%":"50%",this.form_input_container_width=window.innerWidth<=700?"80%":"50%",this.form_input_container_height=window.innerWidth<=700?"10%":"20%",this.sizeState=!(window.innerWidth<700),this.lightTheme=!0,this.loginForm=this.formBuilder.group({email:new r.NI("",[r.kI.required,r.kI.email]),password:new r.NI("",[r.kI.required])})}ngOnInit(){this.store.select(w.d).subscribe(o=>{this.user=o}),this.siteAdjustments.myValue$.subscribe(o=>{this.lightTheme=o})}get emailInput(){return this.loginForm.get("email")}get passwordInput(){return this.loginForm.get("password")}loginUser(){this.loginForm.invalid?this.loginForm.markAllAsTouched():(this.spinner.show("primary"),this.loadingState=!0,this.authServ.login(this.emailInput.value,this.passwordInput.value).pipe((0,f.q)(1),(0,v.x)(()=>{this.spinner.hide(),this.loadingState=!1})).subscribe({next:o=>{o?.jwt?(this.authServ.setPermissions(o.jwt),this.router.navigate(["/user",this.user.id])):this.setInvalidCredentialsError()},error:o=>{this.handleError(o)}}))}handleError(o){0===o.status?(console.error("An error occurred:",o.error),this.setInvalidCredentialsError()):(console.error(`Backend returned code ${o.status}, body was: `,o.error),this.setInvalidCredentialsError())}setInvalidCredentialsError(){this.passwordInput.setErrors({...this.passwordInput.errors??{},invalidCredentials:!0}),this.passwordInput.markAsTouched(),this.passwordInput.markAsDirty()}clearInvalidCredentialsError(){const o=this.passwordInput.errors;if(!o?.invalidCredentials)return;const{invalidCredentials:s,...n}=o;this.passwordInput.setErrors(Object.keys(n).length?n:null),this.passwordInput.updateValueAndValidity({onlySelf:!0,emitEvent:!1})}static#t=this.\u0275fac=function(s){return new(s||i)(t.Y36(l.F0),t.Y36(I.yh),t.Y36(u.t2),t.Y36(r.qu),t.Y36(C.e),t.Y36(Z.c))};static#i=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-login"]],decls:21,vars:20,consts:[[1,"login-page"],["action","",1,"login-form",3,"formGroup","ngSubmit"],["appearance","outline","color","accent",1,"form-field"],["matInput","","type","text","required","",3,"formControl"],["matInput","","type","password","required","",3,"formControl"],[1,"btn-container"],["mat-raised-button","","color","warn","type","submit"],["class","login-form",3,"position","width","height",4,"ngIf"],["mat-raised-button","","color","primary","type","submit"],[1,"login-form"],["size","small","template","<img src='assets/dragonspin.gif' />","bdColor","transparent",1,"spinner",3,"fullScreen"]],template:function(s,n){1&s&&(t.TgZ(0,"div",0)(1,"form",1),t.NdJ("ngSubmit",function(){return n.loginUser()}),t.TgZ(2,"div")(3,"h1"),t._uU(4,"Login"),t.qZA()(),t.TgZ(5,"mat-form-field",2)(6,"mat-label"),t._uU(7,"Email"),t.qZA(),t._UZ(8,"input",3),t.YNc(9,T,2,0,"mat-error")(10,y,2,0,"mat-error"),t.qZA(),t.TgZ(11,"mat-form-field",2)(12,"mat-label"),t._uU(13,"Password"),t.qZA(),t._UZ(14,"input",4),t.YNc(15,A,2,0,"mat-error")(16,U,2,0),t.qZA(),t.TgZ(17,"div",5),t.YNc(18,b,2,0,"button",6)(19,E,2,0),t.qZA()(),t.YNc(20,L,2,7,"div",7),t.qZA()),2&s&&(t.xp6(1),t.Udp("width",n.container_width)("height",n.container_height),t.Q6J("formGroup",n.loginForm),t.xp6(4),t.Udp("width",n.form_input_container_width)("height",n.form_input_container_height),t.xp6(3),t.Q6J("formControl",n.emailInput),t.xp6(1),t.um2(9,n.emailInput.hasError("required")&&(n.emailInput.touched||n.emailInput.dirty)?9:-1),t.xp6(1),t.um2(10,n.emailInput.hasError("email")&&(n.emailInput.touched||n.emailInput.dirty)?10:-1),t.xp6(1),t.Udp("width",n.form_input_container_width)("height",n.form_input_container_height),t.xp6(3),t.Q6J("formControl",n.passwordInput),t.xp6(1),t.um2(15,n.passwordInput.hasError("invalidCredentials")&&(n.passwordInput.touched||n.passwordInput.dirty)?15:n.passwordInput.hasError("required")&&(n.passwordInput.touched||n.passwordInput.dirty)?16:-1),t.xp6(3),t.um2(18,n.emailInput.invalid?18:19),t.xp6(2),t.Q6J("ngIf",n.loadingState))},dependencies:[p.O5,r._Y,r.Fj,r.JJ,r.JL,r.Q7,r.oH,r.sg,u.Ro,m.Nt,d.KE,d.hX,d.TO,g.lW],styles:[".wallpaper-login[_ngcontent-%COMP%]{position:absolute;height:100vh;width:100vw;top:0;left:0;overflow:hidden;z-index:-1}.big-screen-wallpaper[_ngcontent-%COMP%]{position:relative;height:100%;width:100%;background-color:#000}.wallpaper-img-wrapper[_ngcontent-%COMP%]{position:relative;height:100%;width:100%;overflow:hidden;background-color:#000}.wallpaper-img[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:100%;width:100%;object-fit:cover;display:block}"]})}return i})()}];let Y=(()=>{class i{static#t=this.\u0275fac=function(s){return new(s||i)};static#i=this.\u0275mod=t.oAB({type:i});static#n=this.\u0275inj=t.cJS({imports:[l.Bz.forChild(S),l.Bz]})}return i})(),F=(()=>{class i{static#t=this.\u0275fac=function(s){return new(s||i)};static#i=this.\u0275mod=t.oAB({type:i});static#n=this.\u0275inj=t.cJS({imports:[p.ez,Y,r.UX,r.u5,u.ef,m.c,d.lN,g.ot,l.Bz]})}return i})()}}]);