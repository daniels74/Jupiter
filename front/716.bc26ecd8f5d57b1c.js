"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[716],{1716:(j,m,e)=>{e.r(m),e.d(m,{LoginModule:()=>Y});var d=e(6814),l=e(4190),t=e(9212),n=e(6223),p=e(3019),w=e(8180),v=e(6306),x=e(8504),C=e(9530),g=e(1993),I=e(173),u=e(8672),E=e(1154),Z=e(5470),c=e(2032),h=e(9157),f=e(2296);function T(o,a){if(1&o&&(t.TgZ(0,"mat-error"),t._uU(1),t.qZA()),2&o){const i=t.oxw(2);t.xp6(1),t.Oqu(i.emailErrorMessage())}}function M(o,a){if(1&o&&(t.TgZ(0,"mat-error"),t._uU(1),t.qZA()),2&o){const i=t.oxw(2);t.xp6(1),t.Oqu(i.passwordErrorMessage())}}function S(o,a){1&o&&(t.TgZ(0,"button",7),t._uU(1,"Login"),t.qZA())}function b(o,a){1&o&&(t.TgZ(0,"button",8),t._uU(1,"Login"),t.qZA())}function L(o,a){if(1&o){const i=t.EpF();t.TgZ(0,"form",3),t.NdJ("ngSubmit",function(){t.CHM(i);const s=t.oxw();return t.KtG(s.loginUser())}),t.TgZ(1,"div")(2,"h1"),t._uU(3,"Login"),t.qZA()(),t.TgZ(4,"mat-form-field",4)(5,"mat-label"),t._uU(6,"Email"),t.qZA(),t._UZ(7,"input",5),t.YNc(8,T,2,1,"mat-error"),t.qZA(),t.TgZ(9,"mat-form-field",4)(10,"mat-label"),t._uU(11,"Password"),t.qZA(),t._UZ(12,"input",5),t.YNc(13,M,2,1,"mat-error"),t.qZA(),t.TgZ(14,"div",6),t.YNc(15,S,2,0,"button",7)(16,b,2,0),t.qZA()()}if(2&o){const i=t.oxw();t.Udp("width",i.container_width)("height",i.container_height),t.Q6J("formGroup",i.loginForm),t.xp6(4),t.Udp("width",i.form_input_container_width)("height",i.form_input_container_height),t.xp6(3),t.Q6J("formControl",i.emailInput),t.xp6(1),t.um2(8,i.emailInput.invalid?8:-1),t.xp6(1),t.Udp("width",i.form_input_container_width)("height",i.form_input_container_height),t.xp6(3),t.Q6J("formControl",i.passwordInput),t.xp6(1),t.um2(13,i.passwordInput.invalid?13:-1),t.xp6(2),t.um2(15,i.emailInput.invalid?15:16)}}function y(o,a){if(1&o&&(t.TgZ(0,"div",9),t._UZ(1,"ngx-spinner",10),t.qZA()),2&o){const i=t.oxw();t.Udp("width",i.container_width)("height",i.container_height),t.xp6(1),t.Q6J("fullScreen",!1)}}const A=[{path:"",component:(()=>{class o{constructor(i,r,s,J,F,N){this.router=i,this.store=r,this.spinner=s,this.formBuilder=J,this.authServ=F,this.siteAdjustments=N,this.loadingState=!1,this.container_width=window.innerWidth<=700?"95%":"50%",this.container_height=window.innerWidth<=700?"75%":"50%",this.form_input_container_width=window.innerWidth<=700?"80%":"50%",this.form_input_container_height=window.innerWidth<=700?"10%":"20%",this.sizeState=!(window.innerWidth<700),this.lightTheme=!0,this.loginForm=this.formBuilder.group({email:new n.NI("",[n.kI.required,n.kI.email]),password:new n.NI("",[n.kI.required])}),this.emailErrorMessage=(0,t.tdS)(""),this.passwordErrorMessage=(0,t.tdS)(""),(0,p.T)(this.emailInput.statusChanges,this.emailInput.valueChanges).pipe((0,g.sL)()).subscribe(()=>{this.updateEmailErrorMsg()}),(0,p.T)(this.passwordInput.statusChanges,this.passwordInput.valueChanges).pipe((0,g.sL)()).subscribe(()=>{this.updatePasswordErrorMesg()})}ngOnInit(){this.store.select(C.d).subscribe(i=>{this.user=i}),this.siteAdjustments.myValue$.subscribe(i=>{this.lightTheme=i})}get emailInput(){return this.loginForm.get("email")}get passwordInput(){return this.loginForm.get("password")}updateEmailErrorMsg(){this.emailInput.hasError("required")?this.emailErrorMessage.set("You must enter a value"):this.emailInput.hasError("email")?this.emailErrorMessage.set("Not a valid email"):this.emailErrorMessage.set("")}updatePasswordErrorMesg(){this.passwordInput.hasError("required")?this.passwordErrorMessage.set("You must enter a value"):this.passwordErrorMessage.set("")}loginUser(){this.spinner.show("primary"),this.loadingState=!0,this.authServ.login(this.emailInput.value,this.passwordInput.value).pipe((0,w.q)(1)).pipe((0,v.K)(this.handleError)).subscribe(i=>{setTimeout(()=>{i?(this.spinner.hide(),this.loadingState=!1,this.authServ.setPermissions(i.jwt),this.router.navigate(["/user",this.user.id])):console.log("Password or Email Incorrect ! ")},3e3)})}handleError(i){return 0===i.status?console.error("An error occurred:",i.error):console.error(`Backend returned code ${i.status}, body was: `,i.error),(0,x._)(()=>new Error("Something bad happened; please try again later."))}static#t=this.\u0275fac=function(r){return new(r||o)(t.Y36(l.F0),t.Y36(I.yh),t.Y36(u.t2),t.Y36(n.qu),t.Y36(E.e),t.Y36(Z.c))};static#i=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-login"]],decls:3,vars:2,consts:[[1,"login-page"],["action","","class","login-form",3,"formGroup","width","height","ngSubmit",4,"ngIf"],["class","login-form",3,"width","height",4,"ngIf"],["action","",1,"login-form",3,"formGroup","ngSubmit"],["appearance","outline","color","accent",1,"form-field"],["matInput","","type","text","required","",3,"formControl"],[1,"btn-container"],["mat-raised-button","","color","warn","type","submit"],["mat-raised-button","","color","primary","type","submit"],[1,"login-form"],["size","small","template","<img src='assets/dragonspin.gif' />","bdColor","transparent",1,"spinner",3,"fullScreen"]],template:function(r,s){1&r&&(t.TgZ(0,"div",0),t.YNc(1,L,17,18,"form",1)(2,y,2,5,"div",2),t.qZA()),2&r&&(t.xp6(1),t.Q6J("ngIf",!s.loadingState),t.xp6(1),t.Q6J("ngIf",s.loadingState))},dependencies:[d.O5,n._Y,n.Fj,n.JJ,n.JL,n.Q7,n.oH,n.sg,u.Ro,c.Nt,h.KE,h.hX,h.TO,f.lW],styles:[".wallpaper-login[_ngcontent-%COMP%]{position:absolute;height:100vh;width:100vw;top:0;left:0;overflow:hidden;z-index:-1}.big-screen-wallpaper[_ngcontent-%COMP%]{position:relative;height:100%;width:100%;background-color:#000}.wallpaper-img-wrapper[_ngcontent-%COMP%]{position:relative;height:100%;width:100%;overflow:hidden;background-color:#000}.wallpaper-img[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:100%;width:100%;object-fit:cover;display:block}"]})}return o})()}];let U=(()=>{class o{static#t=this.\u0275fac=function(r){return new(r||o)};static#i=this.\u0275mod=t.oAB({type:o});static#o=this.\u0275inj=t.cJS({imports:[l.Bz.forChild(A),l.Bz]})}return o})(),Y=(()=>{class o{static#t=this.\u0275fac=function(r){return new(r||o)};static#i=this.\u0275mod=t.oAB({type:o});static#o=this.\u0275inj=t.cJS({imports:[d.ez,U,n.UX,n.u5,u.ef,c.c,h.lN,f.ot,l.Bz]})}return o})()}}]);